<template>
    
    <lightning-card>

        <!--  Title -->

        <h3 slot="title">
            <lightning-icon class="einstein-icon slds-m-right_small" icon-name="utility:einstein" size="small"></lightning-icon> EinsteinGPT Assistant
        </h3>

        <div class="scroller">
            <template if:true={showEmptyChatState}>
                <div class="stretch">
                    <template if:true={user}>
                        <div class="slds-grid slds-wrap stretch">
                            <div class="slds-size_1-of-1 stretch">
                                <div class="slds-grid slds-wrap slds-p-around_medium slds-align_absolute-center stretch">
                                    <div class="slds-size_1-of-1 slds-align_absolute-center">
                                        <img style="max-width:60%" src="/resource/1680717507000/demoEinsteinGPTImages/l4sodx4l2pkorexhbw17.png" />
                                    </div>
                                    <div class="slds-size_1-of-1">
                                        <h1 class="slds-text-heading_medium slds-p-top_medium slds-text-align_center">Welcome {user.FirstName}</h1>
                                    </div>
                                    <div class="slds-size_1-of-1 slds-p-left_xx-large slds-p-right_xx-large">
                                        <p class="slds-text-body_regular slds-p-top_small slds-text-align_center">Einstein is here to help. Ask a question or make a request to generate a response.</p>
                                    </div>
                                </div>
                            </div>
                        </div>    
                    </template>
                </div>
            </template>
            <template if:false={showEmptyChatState}>
                <div class="slds-grid slds-wrap ">
                    <template for:each={messages} for:item="message" for:index="i">
                        <div class="slds-size_1-of-1" key={message.i}>
                            <c-einstein-g-p-t-chat-message message={message}></c-einstein-g-p-t-chat-message>
                        </div>
                    </template>
                    <template if:true={loading}>
                        <div class="spinner-container slds-size_1-of-1">
                            <lightning-spinner size="small"></lightning-spinner>
                        </div>
                    </template>    
                </div>
            </template>
        </div>
        
        <div class="input-box slds-p-around_medium">
            <div class="slds-grid slds-wrap">
                <div class="slds-size_1-of-1">
                    <div class="slds-grid slds-wrap slds-grid_align-spread">
                        <div class="slds-size_11-of-12">
                            <lightning-input class="slds-p-right_x-small" type="text" label="Ask Einstein" oncommit={handleInputCommit}></lightning-input>
                        </div>
                        <div class="slds-size_1-of-12 slds-align-bottom slds-text-align_right">
                            <lightning-button-icon icon-name="utility:send"></lightning-button-icon>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </lightning-card>


</template>